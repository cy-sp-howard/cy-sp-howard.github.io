import{d as k,r as x,i as v,n as M,w as C,T as b,G as _,q as d,j as g,B as T,C as h,l as i,k as m,t as y,o as B,F as E,_ as p,a4 as w,a5 as f,E as V,c as j}from"./index-12087f41.js";const F={key:0},N=["onClick"],S=k({__name:"rkMsg",setup(t,{expose:u}){const o=x([]);let l=0;function e(s){if(!s.text)return;const n=_.assign({key:++l},s);return o.value.push(n),new Promise(a=>{setTimeout(()=>{c(n.key),a(void 0)},s.duration||3e3)})}function c(s){o.value=_.reject(o.value,n=>n.key===s)}return u({addMsg:e}),(s,n)=>{const a=v("svg-icon");return d(),M(b,{id:"msg-wrapper",tag:"ul",name:"msg"},{default:C(()=>[(d(!0),g(E,null,T(o.value,r=>(d(),g("li",{class:h(["rk-msg",r.type]),key:r.key},[i("span",null,[m(a,{icon:r.type==="error"?"err":"success"},null,8,["icon"]),i("h3",null,[i("b",null,y(r.text),1),r.subText?(d(),g("small",F,y(r.subText),1)):B("",!0)]),i("button",{onClick:I=>c(r.key)},[m(a,{icon:"close"})],8,N)])],2))),128))]),_:1})}}});const $=p(S,[["__scopeId","data-v-98c78765"]]),G=w({component:{setup(){return{main:x(null)}},render(){return f(V,{to:"body"},f($,{ref:"main"}))}}}).instance;function O(){var o;const t=((o=G.main)==null?void 0:o.addMsg)||(()=>{}),{texts:u}=j("Web");return{addMsg:t,addApiMsg:(l,e)=>{if(e instanceof Object){if("Code"in e&&e.Code===0)t({text:l+u.value.成功});else if("Code"in e){const c=_.omitBy(e,a=>a===null),s=_.isEmpty(c)?void 0:JSON.stringify(c),n=e.Message==="ResultCode_Fail"||!e.Message;t({text:n?l+u.value.失败:e.Message||"",subText:n?s:"",type:"error"})}else"status"in e&&e.status!==200?t({text:`${e.status} ${e.statusText}`,type:"error"}):e instanceof Error&&t({text:e.message,type:"error"});return}t({text:String(e),type:"error"})}}}export{O as default};
